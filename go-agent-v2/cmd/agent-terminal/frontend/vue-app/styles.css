* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --bg-base: #000;
  --surface: #181818;
  --card: #212121;
  --card-hover: #2a2a2a;
  --elevated: #282828;
  --primary: #b4b9c3;
  --primary-dim: rgba(180, 185, 195, 0.14);
  --success: #40c977;
  --error: #ff6764;
  --warning: #ff8549;
  --info: #b4b9c3;
  --text: #fff;
  --text-sec: #ffffffb3;
  --text-muted: #ffffff80;
  --text-subtle: #ffffff4d;
  --border: #ffffff14;
  --border-hover: #ffffff29;
  --hover: #ffffff08;
  --selected: rgba(180, 185, 195, 0.14);
  --chat-bg: #000;
  --chat-user-bg: #212121;
  --chat-user-border: #ffffff14;
  --chat-assistant-bg: transparent;
  --chat-assistant-border: transparent;
  --chat-system-bg: #181818;
  --chat-system-border: #ffffff14;
  --chat-thinking-bg: rgba(180, 185, 195, 0.08);
  --chat-command-bg: rgba(64, 201, 119, 0.06);
  --chat-danger-bg: rgba(255, 103, 100, 0.06);
  --chat-pill-bg: #ffffff0d;
  --radius: 8px;
  --radius-sm: 5px;
  --sidebar-w: 56px;
  --transition: 200ms ease;
}

html,
body,
#app {
  width: 100%;
  height: 100%;
}

body {
  font-family: -apple-system, "Hiragino Sans GB", "SF Pro Text", sans-serif;
  background: var(--bg-base);
  color: var(--text);
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
}

button,
input,
select,
textarea,
a,
#content,
.page,
.sidebar-btn,
#sidebar,
#toolbar,
.chat-toolbar {
  -webkit-app-region: no-drag;
}

.app-shell {
  display: flex;
  width: 100%;
  height: 100%;
}

.app-exit-overlay {
  position: fixed;
  inset: 0;
  z-index: 20000;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at center, rgba(9, 14, 24, 0.56) 0%, rgba(2, 6, 14, 0.9) 100%);
  opacity: 0;
  pointer-events: none;
  transition: opacity 180ms ease;
}

.app-exit-overlay.active {
  opacity: 1;
}

.app-exit-overlay-inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  transform: translateY(8px);
  transition: transform 180ms ease;
}

.app-exit-overlay.active .app-exit-overlay-inner {
  transform: translateY(0);
}

.app-exit-overlay-icon {
  width: 120px;
  height: 120px;
  border-radius: 26px;
  box-shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
}

.app-exit-overlay-text {
  color: #dbeafe;
  font-size: 13px;
  letter-spacing: 0.04em;
}

#sidebar {
  width: var(--sidebar-w);
  background: var(--surface);
  display: flex;
  flex-direction: column;
  padding: 10px 0;
  gap: 2px;
  flex-shrink: 0;
  border-right: 1px solid var(--elevated);
}

.sidebar-btn {
  width: 100%;
  border: none;
  background: transparent;
  color: inherit;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 52px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background var(--transition);
  position: relative;
  user-select: none;
}

.sidebar-btn:hover {
  background: var(--hover);
}

.sidebar-btn.active {
  background: var(--selected);
}

.sidebar-btn.active::before {
  content: "";
  position: absolute;
  left: 0;
  top: 25%;
  width: 3px;
  height: 50%;
  border-radius: 1.5px;
  background: var(--primary);
}

.sb-icon {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-muted);
  transition: color var(--transition);
}

.sb-label {
  font-size: 9px;
  font-weight: 500;
  color: var(--text-subtle);
  margin-top: 3px;
  transition: color var(--transition);
}

.sidebar-btn.active .sb-icon {
  color: var(--primary);
}

.sidebar-btn.active .sb-label {
  color: var(--text-sec);
}

.sidebar-spacer {
  flex: 1;
}

#content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-width: 0;
}

.page {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  min-height: 0;
}

.unified-chat-page,
#page-tasks,
#page-settings {
  --primary: #c4c4c4;
  --primary-dim: rgba(255, 255, 255, 0.12);
  --info: #c4c4c4;
  --selected: rgba(255, 255, 255, 0.1);
  --chat-thinking-bg: rgba(255, 255, 255, 0.06);
  --color-accent-blue: #c4c4c4;
  --color-border-focus: rgba(255, 255, 255, 0.68);
  --color-text-accent: #e5e7eb;
  --assistant-accent: rgba(201, 201, 201, 0.62);
  --assistant-accent-strong: rgba(229, 229, 229, 0.84);
  --assistant-surface: rgba(255, 255, 255, 0.04);
  --assistant-surface-hover: rgba(255, 255, 255, 0.08);
  --assistant-link: #d1d5db;
  --assistant-link-hover: #f3f4f6;
}

.unified-chat-page .btn-primary,
#page-tasks .btn-primary,
#page-settings .btn-primary {
  color: #111;
}

.panel-header {
  display: flex;
  align-items: center;
  height: 52px;
  background: var(--surface);
  padding: 0 20px;
  gap: 8px;
  border-bottom: 1px solid var(--elevated);
  flex-shrink: 0;
}

.ph-bar {
  width: 3px;
  height: 18px;
  border-radius: 1.5px;
  background: var(--primary);
}

.ph-text h2 {
  font-size: 15px;
  font-weight: 700;
}

.ph-sub {
  font-size: 10px;
  color: var(--text-muted);
}

.panel-body {
  flex: 1;
  overflow: auto;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.sub-tabs {
  display: flex;
  padding: 4px 20px;
  gap: 4px;
  flex-shrink: 0;
  border-bottom: 1px solid var(--elevated);
}

.sub-tab {
  height: 32px;
  padding: 0 16px;
  border: none;
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 400;
  color: var(--text-muted);
  background: transparent;
  cursor: pointer;
}

.sub-tab.active {
  background: var(--primary-dim);
  color: var(--text);
  font-weight: 600;
  border: 1px solid var(--border-hover);
}

.section-header {
  height: 34px;
  display: flex;
  align-items: center;
  padding: 0 20px;
  gap: 4px;
  background: var(--surface);
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  letter-spacing: 0.5px;
}

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  flex: 1;
  gap: 8px;
  padding: 32px;
}

.es-icon {
  width: 48px;
  height: 48px;
  border-radius: 24px;
  background: var(--primary-dim);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 700;
  color: var(--primary);
}

.empty-state h3 {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
}

.empty-state p {
  font-size: 11px;
  color: var(--text-subtle);
}

.split-panel {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.split-left,
.split-right {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.split-divider {
  width: 1px;
  background: var(--elevated);
}

.btn {
  height: 28px;
  padding: 0 14px;
  border: none;
  border-radius: 5px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 200ms;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-primary {
  background: var(--primary);
  color: #fff;
}

.btn-primary:hover:not(:disabled) {
  filter: brightness(1.15);
}

.btn-secondary {
  background: var(--card);
  color: var(--text-sec);
  border: 1px solid var(--border);
}

.btn-secondary:hover:not(:disabled) {
  border-color: var(--border-hover);
  color: var(--text);
}

.btn-ghost {
  background: transparent;
  color: var(--text-muted);
}

.btn-ghost:hover:not(:disabled) {
  color: var(--text-sec);
}

.btn-warning {
  color: var(--warning);
}

.btn-warning:hover:not(:disabled) {
  color: #fbbf24;
  background: rgba(245, 158, 11, 0.12);
}

.btn-xs {
  font-size: 10px !important;
  padding: 2px 8px !important;
}

#toolbar {
  display: flex;
  align-items: center;
  height: 48px;
  background: var(--surface);
  border-bottom: 1px solid var(--elevated);
  padding: 0 16px;
  gap: 16px;
  flex-shrink: 0;
}

.toolbar-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.logo {
  font-size: 13px;
  font-weight: 700;
  color: var(--primary);
  letter-spacing: 0.5px;
}

.toolbar-center {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  justify-content: center;
}

.toolbar-center label {
  font-size: 12px;
  color: var(--text-muted);
  font-weight: 500;
}

.toolbar-center input {
  width: 56px;
  height: 28px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text);
  font-size: 13px;
  text-align: center;
  outline: none;
}

.toolbar-center input:focus {
  border-color: var(--primary);
}

.toolbar-right {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 600;
}

.project-select-wrap {
  display: flex;
  align-items: center;
  gap: 8px;
}

.project-selector {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 4px 10px;
  color: var(--text-sec);
  font-size: 12px;
  font-weight: 600;
  outline: none;
  max-width: 220px;
  cursor: pointer;
  transition: border-color var(--transition);
}

.project-selector:focus {
  border-color: var(--border-hover);
}

.project-selector option {
  background: var(--surface);
  color: var(--text);
}

.project-add-btn {
  width: 30px;
  height: 30px;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.project-add-btn svg {
  width: 15px;
  height: 15px;
  display: block;
}

.terminal-grid {
  flex: 1;
  overflow: auto;
  padding: 16px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 12px;
}

.thread-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.thread-card-head {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
}

.thread-card-head small {
  display: block;
  margin-top: 4px;
  font-size: 11px;
  color: var(--text-muted);
}

.thread-card-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.badge {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 999px;
  background: var(--primary-dim);
  color: var(--primary);
  border: 1px solid var(--border);
}

.badge-muted,
.badge-idle {
  color: var(--text-muted);
}

.badge-error {
  color: var(--error);
}

.badge-running,
.badge-starting,
.badge-thinking,
.badge-responding {
  color: var(--primary);
}

.badge-editing,
.badge-waiting {
  color: var(--warning);
}

.badge-syncing {
  color: var(--info);
}

.chat-workspace {
  display: flex;
  flex: 1;
  overflow: hidden;
  background: var(--chat-bg);
}

#agent-workspace {
  display: flex;
  flex: 1;
  overflow: hidden;
}

#chat-panel,
.chat-panel-only {
  flex: 6;
  min-width: 320px;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: transparent;
  border-right: 1px solid rgba(255, 255, 255, 0.12);
  position: relative;
}

.chat-toolbar {
  display: flex;
  align-items: center;
  flex-wrap: nowrap;
  padding: 10px 14px;
  background: linear-gradient(180deg, rgba(26, 26, 26, 0.96) 0%, rgba(16, 16, 16, 0.98) 100%);
  border-bottom: 1px solid var(--border);
  gap: 8px;
  flex-shrink: 0;
  min-width: 0;
  overflow-x: auto;
  overflow-y: hidden;
  box-shadow: inset 0 -1px 0 rgba(255, 255, 255, 0.06);
}

.chat-running-card {
  flex-shrink: 0;
  min-width: 0;
  max-width: min(48vw, 340px);
  height: 34px;
  border: 1px solid rgba(255, 255, 255, 0.32);
  border-radius: 11px;
  background: linear-gradient(180deg, rgba(34, 34, 34, 0.92) 0%, rgba(20, 20, 20, 0.95) 100%);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.06);
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 0 10px;
}

.chat-running-spinner {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
  animation: chat-status-spin 0.95s linear infinite;
}

.chat-running-spinner-track,
.chat-running-spinner-arc {
  stroke-width: 2.2;
}

.chat-running-spinner-track {
  stroke: rgba(255, 255, 255, 0.24);
}

.chat-running-spinner-arc {
  stroke: rgba(248, 250, 252, 0.96);
  stroke-linecap: round;
  stroke-dasharray: 18 60;
}

.chat-running-copy {
  min-width: 0;
  display: inline-flex;
  align-items: center;
  gap: 7px;
  color: var(--text-sec);
}

.chat-running-copy strong {
  font-size: 11px;
  line-height: 1;
  color: var(--text);
  white-space: nowrap;
}

.chat-running-copy span {
  min-width: 0;
  font-size: 10px;
  color: var(--text-subtle);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-status {
  display: flex;
  align-items: center;
  gap: 6px;
  color: var(--text-muted);
  border: 1px solid var(--border);
  background: rgba(33, 33, 33, 0.7);
  border-radius: 999px;
}

.chat-status-meta {
  color: var(--text-subtle);
  white-space: nowrap;
}

.chat-status .status-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: var(--text-subtle);
  flex-shrink: 0;
}

.chat-status .status-dot.thinking,
.chat-status .status-dot.starting,
.chat-status .status-dot.syncing {
  background: var(--warning);
  animation: pulse 1.2s infinite;
}

.chat-status .status-dot.waiting {
  background: var(--success);
  animation: pulse 1.2s infinite;
}

.chat-status .status-dot.running {
  background: var(--success);
}

.chat-status .status-dot.responding {
  background: var(--info);
}

.chat-status .status-dot.editing {
  background: var(--primary);
}

.chat-status .status-dot.error {
  background: var(--error);
}

.chat-status .status-dot.idle {
  background: var(--text-subtle);
}

.chat-toolbar .chat-status {
  margin-left: auto;
  min-width: 0;
  max-width: min(50vw, 620px);
  flex-shrink: 1;
  font-size: 11px;
  padding: 4px 10px;
}

.chat-toolbar .btn,
.chat-toolbar .layout-switch,
.chat-toolbar .project-select-wrap {
  flex-shrink: 0;
  white-space: nowrap;
}

.chat-toolbar .chat-status>span:not(.status-dot) {
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-toolbar .chat-status-meta {
  font-size: 10px;
}

.unified-chat-page .unified-main {
  flex: 1;
  min-height: 0;
  display: flex;
}

.unified-chat-page .thread-rail {
  flex: 0 0 232px;
  width: 232px;
  min-width: 188px;
  max-width: 420px;
  min-height: 0;
  display: flex;
  flex-direction: column;
  border-right: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(20, 20, 20, 0.96) 0%, rgba(12, 12, 12, 0.98) 100%);
  transition: box-shadow 0.2s ease;
}

.unified-chat-page .thread-rail.dragging {
  box-shadow: inset -1px 0 0 rgba(255, 255, 255, 0.12);
}

.unified-chat-page .thread-rail-header {
  padding: 12px 12px 10px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.unified-chat-page .thread-rail-header-main {
  min-width: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.unified-chat-page .thread-rail-kind-icon,
.unified-chat-page .thread-rail-count-chip {
  border: 1px solid rgba(255, 255, 255, 0.28);
  border-radius: 999px;
  background: rgba(33, 33, 33, 0.8);
  color: var(--text-sec);
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.unified-chat-page .thread-rail-kind-icon {
  width: 26px;
  height: 26px;
}

.unified-chat-page .thread-rail-kind-icon svg {
  width: 14px;
  height: 14px;
  display: block;
}

.unified-chat-page .thread-rail-count-chip {
  min-width: 50px;
  height: 26px;
  padding: 0 8px;
  gap: 4px;
}

.unified-chat-page .thread-rail-count-icon {
  width: 12px;
  height: 12px;
  display: block;
}

.unified-chat-page .thread-rail-count-chip strong {
  font-size: 11px;
  line-height: 1;
  color: var(--text);
}

.unified-chat-page .thread-rail-switch-btn {
  flex-shrink: 0;
  width: 26px;
  height: 26px;
  border: 1px solid rgba(255, 255, 255, 0.32);
  border-radius: 999px;
  background: rgba(33, 33, 33, 0.92);
  color: var(--text-muted);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  cursor: pointer;
  transition: border-color var(--transition), color var(--transition), background var(--transition);
}

.unified-chat-page .thread-rail-switch-btn svg {
  width: 13px;
  height: 13px;
  display: block;
}

.unified-chat-page .thread-rail-switch-btn:hover {
  border-color: rgba(255, 255, 255, 0.52);
  color: var(--text-sec);
  background: rgba(58, 58, 58, 0.92);
}

.unified-chat-page .thread-rail-switch-btn.active {
  border-color: rgba(248, 228, 160, 0.72);
  color: rgba(248, 228, 160, 0.95);
  background: rgba(120, 97, 18, 0.2);
}

.unified-chat-page .thread-rail-switch-btn:focus-visible {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-empty {
  margin: 10px 10px 0;
  padding: 10px;
  border: 1px dashed var(--border);
  border-radius: var(--radius-sm);
  background: rgba(33, 33, 33, 0.5);
  font-size: 12px;
  line-height: 1.5;
  color: var(--text-muted);
}

.unified-chat-page .thread-rail-list {
  flex: 1;
  min-height: 0;
  overflow: auto;
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.unified-chat-page .thread-rail-item {
  width: 100%;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: rgba(33, 33, 33, 0.45);
  padding: 9px 10px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  cursor: pointer;
  color: var(--text-sec);
  text-align: left;
  transition: border-color 180ms ease, background 180ms ease, box-shadow 180ms ease;
}

.unified-chat-page .thread-rail-item:hover {
  border-color: var(--border-hover);
  background: rgba(255, 255, 255, 0.1);
}

.unified-chat-page .thread-rail-item:focus-visible {
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.16);
  outline: none;
}

.unified-chat-page .thread-rail-item.active {
  border-color: rgba(255, 255, 255, 0.56);
  background: rgba(255, 255, 255, 0.14);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-item.archived {
  border-style: dashed;
  opacity: 0.8;
}

.unified-chat-page .thread-rail-item.archived .thread-rail-item-meta {
  color: var(--text-subtle);
}

.unified-chat-page .thread-rail-item-head {
  display: flex;
  align-items: center;
  gap: 6px;
}

.unified-chat-page .thread-rail-item-head strong {
  flex: 1;
  min-width: 0;
  font-size: 12px;
  line-height: 1.3;
  color: var(--text);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.unified-chat-page .thread-rail-name {
  cursor: text;
}

.unified-chat-page .thread-rail-alias-input {
  flex: 1;
  min-width: 0;
  height: 24px;
  border: 1px solid rgba(255, 255, 255, 0.42);
  border-radius: 6px;
  background: rgba(24, 24, 24, 0.92);
  color: var(--text);
  font-size: 12px;
  line-height: 1.3;
  padding: 2px 8px;
  outline: none;
}

.unified-chat-page .thread-rail-alias-input:focus-visible {
  border-color: rgba(255, 255, 255, 0.78);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-alias-input:disabled {
  opacity: 0.72;
  cursor: progress;
}

.unified-chat-page .thread-rail-save-btn {
  flex-shrink: 0;
  height: 24px;
  min-width: 36px;
  border: 1px solid rgba(255, 255, 255, 0.42);
  border-radius: 6px;
  background: rgba(42, 42, 42, 0.94);
  color: var(--text-sec);
  font-size: 11px;
  line-height: 1;
  padding: 0 8px;
  cursor: pointer;
  transition: border-color var(--transition), background var(--transition), color var(--transition);
}

.unified-chat-page .thread-rail-save-btn:hover {
  border-color: rgba(255, 255, 255, 0.62);
  background: rgba(78, 78, 78, 0.94);
  color: var(--text);
}

.unified-chat-page .thread-rail-save-btn:focus-visible {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-save-btn:disabled {
  opacity: 0.68;
  cursor: progress;
}

.unified-chat-page .thread-main-badge {
  flex-shrink: 0;
  border: 1px solid rgba(255, 255, 255, 0.46);
  border-radius: 999px;
  padding: 1px 6px;
  font-size: 10px;
  line-height: 1.4;
  color: var(--text-sec);
  background: rgba(255, 255, 255, 0.11);
}

.unified-chat-page .thread-rail-pin-btn {
  flex-shrink: 0;
  width: 24px;
  height: 24px;
  border: 1px solid rgba(255, 255, 255, 0.32);
  border-radius: 999px;
  background: rgba(33, 33, 33, 0.92);
  color: var(--text-muted);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: border-color var(--transition), color var(--transition), background var(--transition);
}

.unified-chat-page .thread-rail-pin-btn svg {
  width: 12px;
  height: 12px;
  display: block;
}

.unified-chat-page .thread-rail-pin-btn:hover {
  border-color: rgba(255, 255, 255, 0.52);
  color: var(--text-sec);
  background: rgba(58, 58, 58, 0.92);
}

.unified-chat-page .thread-rail-pin-btn.active {
  border-color: rgba(255, 255, 255, 0.72);
  color: var(--text);
  background: rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-pin-btn:focus-visible {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-archive-btn {
  flex-shrink: 0;
  width: 24px;
  height: 24px;
  border: 1px solid rgba(255, 255, 255, 0.32);
  border-radius: 999px;
  background: rgba(33, 33, 33, 0.92);
  color: var(--text-muted);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: border-color var(--transition), color var(--transition), background var(--transition);
}

.unified-chat-page .thread-rail-archive-btn svg {
  width: 12px;
  height: 12px;
  display: block;
}

.unified-chat-page .thread-rail-archive-btn:hover {
  border-color: rgba(255, 255, 255, 0.52);
  color: var(--text-sec);
  background: rgba(58, 58, 58, 0.92);
}

.unified-chat-page .thread-rail-archive-btn.active {
  border-color: rgba(248, 228, 160, 0.72);
  color: rgba(248, 228, 160, 0.95);
  background: rgba(120, 97, 18, 0.2);
}

.unified-chat-page .thread-rail-archive-btn:focus-visible {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.16);
}

.unified-chat-page .thread-rail-item-id {
  font-size: 11px;
  color: var(--text-subtle);
  line-height: 1.3;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.unified-chat-page .thread-rail-item-meta {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.3;
}

.unified-chat-page .thread-rail-item-meta span:last-child {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.thread-rail .status-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: var(--text-subtle);
  flex-shrink: 0;
}

.thread-rail .status-dot.thinking,
.thread-rail .status-dot.starting,
.thread-rail .status-dot.syncing {
  background: var(--warning);
  animation: pulse 1.2s infinite;
}

.thread-rail .status-dot.waiting {
  background: var(--success);
  animation: pulse 1.2s infinite;
}

.thread-rail .status-dot.running {
  background: var(--success);
}

.thread-rail .status-dot.responding {
  background: var(--info);
}

.thread-rail .status-dot.editing {
  background: var(--primary);
}

.thread-rail .status-dot.error {
  background: var(--error);
}

.thread-rail .status-dot.idle {
  background: var(--text-subtle);
}

.unified-chat-page .unified-center {
  flex: 1;
  min-width: 0;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.unified-chat-page .workspace-area {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  position: relative;
}

.unified-chat-page .chat-composer-shell {
  width: 100%;
  max-width: 100%;
  min-width: 0;
  display: flex;
  align-self: flex-start;
  flex-shrink: 0;
}

.unified-chat-page .chat-composer-shell.for-chat {
  margin-right: auto;
  position: relative;
  z-index: 12;
  align-self: flex-end;
}

.unified-chat-page .chat-composer-shell .chat-input-vue {
  width: 100%;
}

.unified-chat-page .workspace-bottom-row {
  --activity-panel-base-height: 124px;
  --activity-panel-overlay-height: var(--activity-panel-base-height);
  --activity-panel-fixed-height: var(--activity-panel-base-height);
  display: flex;
  align-items: flex-end;
  min-width: 0;
  flex-shrink: 0;
  overflow: visible;
}

.unified-chat-page .workspace-area,
.unified-chat-page .chat-workspace,
.unified-chat-page .workspace-bottom-row,
.unified-chat-page .workspace-bottom-side,
.unified-chat-page .workspace-bottom-side-layer,
.unified-chat-page .cmd-card-panel,
.unified-chat-page .thread-rail-resizer,
.unified-chat-page .panel-resizer,
.unified-chat-page .activity-panel-resizer {
  -webkit-app-region: no-drag;
}

.unified-chat-page .workspace-bottom-row.is-cmd {
  display: block;
}

.unified-chat-page .workspace-bottom-side {
  flex: 1;
  min-width: 0;
  min-height: var(--activity-panel-base-height);
  height: var(--activity-panel-base-height);
  max-height: var(--activity-panel-base-height);
  display: flex;
  position: relative;
  align-items: flex-end;
  overflow: visible;
  pointer-events: none;
}

.unified-chat-page .workspace-bottom-side-layer {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: var(--activity-panel-overlay-height);
  min-height: var(--activity-panel-base-height);
  display: flex;
  align-items: stretch;
  overflow: hidden;
  border-left: none;
  background: var(--surface);
  box-shadow: 0 -8px 24px rgba(0, 0, 0, 0.28);
  pointer-events: auto;
  z-index: 4;
}

.unified-chat-page .workspace-bottom-side-layer.dragging {
  box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.35);
}

.unified-chat-page .workspace-bottom-side-layer .activity-panel {
  width: 100%;
  flex: none;
  min-height: 100%;
  height: 100%;
  max-height: 100%;
}

.unified-chat-page .activity-panel-resizer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 14px;
  cursor: ns-resize;
  user-select: none;
  touch-action: none;
  z-index: 5;
  background: transparent;
  transition: background 0.2s ease;
}

.unified-chat-page .activity-panel-resizer::after {
  content: none;
}

.unified-chat-page .activity-panel-resizer:hover,
.unified-chat-page .activity-panel-resizer.dragging {
  background: rgba(180, 185, 195, 0.14);
}

body.is-col-resizing,
body.is-col-resizing * {
  cursor: ew-resize !important;
}

body.is-row-resizing,
body.is-row-resizing * {
  cursor: ns-resize !important;
}

.cmd-card-panel {
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  min-height: 220px;
  max-height: 55%;
}

.cmd-card-grid {
  flex: 1;
  min-height: 0;
  overflow: auto;
  display: grid;
  gap: 10px;
}

.cmd-card-grid.cols-2 {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.cmd-card-grid.cols-3 {
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.cmd-thread-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 148px;
  resize: vertical;
  overflow: auto;
}

.cmd-thread-card.active {
  border-color: var(--primary);
  background: var(--selected);
}

.cmd-thread-card.view-overview {
  min-height: 112px;
}

.cmd-thread-card.view-chat {
  min-height: 176px;
}

.cmd-thread-card.view-mix {
  min-height: 220px;
}

.cmd-thread-card-head {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 8px;
}

.cmd-thread-card-head small {
  display: block;
  margin-top: 4px;
  font-size: 11px;
  color: var(--text-muted);
}

.cmd-thread-preview {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.cmd-thread-preview p {
  font-size: 11px;
  color: var(--text-sec);
  line-height: 1.45;
  margin: 0;
  white-space: pre-wrap;
  word-break: break-word;
}

.cmd-thread-preview p.muted {
  color: var(--text-subtle);
}

.cmd-thread-diff {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: rgba(0, 0, 0, 0.12);
  margin: 0;
  padding: 6px 8px;
  font-size: 10px;
  color: var(--text-muted);
  white-space: pre-wrap;
  word-break: break-word;
}

.cmd-thread-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: auto;
}

.agent-overview-panel {
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.workspace-run-panel {
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.workspace-run-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 10px;
}

.workspace-run-title {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.workspace-run-title strong {
  font-size: 13px;
  color: var(--text);
}

.workspace-run-title span {
  font-size: 11px;
  color: var(--text-muted);
}

.overview-metrics {
  display: grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap: 8px;
}

.workspace-run-metrics {
  display: grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap: 8px;
}

.metric {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: var(--card);
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.metric strong {
  font-size: 16px;
  line-height: 1;
  color: var(--text);
}

.metric span {
  font-size: 11px;
  color: var(--text-muted);
}

.overview-recent {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 6px;
}

.recent-label {
  font-size: 11px;
  color: var(--text-muted);
}

.recent-chip {
  height: 24px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: var(--card);
  color: var(--text-sec);
  font-size: 11px;
  padding: 0 10px;
  cursor: pointer;
}

.recent-chip.active {
  border-color: var(--border-hover);
  background: var(--primary-dim);
  color: var(--text);
}

.workspace-run-empty {
  font-size: 12px;
  color: var(--text-muted);
}

.workspace-run-error {
  margin: 0;
  font-size: 12px;
  color: var(--error);
}

.workspace-run-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 8px;
}

.workspace-run-card {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: var(--card);
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.workspace-run-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
}

.workspace-run-row strong {
  font-size: 12px;
  color: var(--text);
}

.workspace-run-meta {
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.4;
}

.workspace-run-badge.workspace-run-active {
  background: rgba(251, 191, 36, 0.15);
  color: #f59e0b;
}

.workspace-run-badge.workspace-run-merging {
  background: rgba(255, 255, 255, 0.14);
  color: #e5e7eb;
}

.workspace-run-badge.workspace-run-merged {
  background: rgba(16, 185, 129, 0.15);
  color: #10b981;
}

.workspace-run-badge.workspace-run-failed,
.workspace-run-badge.workspace-run-aborted {
  background: rgba(248, 113, 113, 0.15);
  color: #ef4444;
}

.layout-switch {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.layout-switch .btn.active {
  color: var(--text);
  background: var(--primary-dim);
  border: 1px solid var(--border-hover);
}

.panel-resizer,
.unified-chat-page .thread-rail-resizer {
  position: relative;
  width: 10px;
  margin: 0 -3px;
  cursor: ew-resize;
  background: transparent;
  transition: background 0.2s, box-shadow 0.2s;
  flex-shrink: 0;
  user-select: none;
  touch-action: none;
  z-index: 5;
}

.panel-resizer::after,
.unified-chat-page .thread-rail-resizer::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: 2px;
  transform: translateX(-50%);
  border-radius: 999px;
  background: rgba(180, 185, 195, 0.42);
  opacity: 0.85;
  transition: background 0.2s, opacity 0.2s, box-shadow 0.2s;
}

.panel-resizer:hover,
.panel-resizer.dragging,
.unified-chat-page .thread-rail-resizer:hover,
.unified-chat-page .thread-rail-resizer.dragging {
  background: rgba(180, 185, 195, 0.12);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1);
}

.panel-resizer:hover::after,
.panel-resizer.dragging::after,
.unified-chat-page .thread-rail-resizer:hover::after,
.unified-chat-page .thread-rail-resizer.dragging::after {
  background: var(--primary);
  opacity: 1;
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.14);
}

#diff-panel {
  flex: 4;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border-left: 1px solid var(--border);
  min-width: 280px;
  background: linear-gradient(180deg, rgba(24, 24, 24, 0.98) 0%, rgba(12, 12, 12, 0.98) 100%);
}

.diff-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 11px 12px;
  border-bottom: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(34, 34, 34, 0.9) 0%, rgba(20, 20, 20, 0.9) 100%);
  box-shadow: inset 0 -1px 0 rgba(255, 255, 255, 0.06);
  flex-shrink: 0;
}

.diff-header-main {
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.diff-header-main strong {
  font-size: 13px;
  line-height: 1.1;
  color: var(--text-sec);
}

.diff-header-main small {
  font-size: 10px;
  color: var(--text-subtle);
}

.diff-header-metrics {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.diff-metric {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 42px;
  height: 22px;
  border-radius: 999px;
  font-size: 10px;
  font-weight: 700;
  border: 1px solid transparent;
  font-family: "SF Mono", "Menlo", monospace;
}

.diff-metric.add {
  color: #4ade80;
  background: rgba(34, 197, 94, 0.14);
  border-color: rgba(74, 222, 128, 0.3);
}

.diff-metric.del {
  color: #fca5a5;
  background: rgba(248, 113, 113, 0.15);
  border-color: rgba(248, 113, 113, 0.32);
}

#diff-content {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
  font-family: "Menlo", "SF Mono", monospace;
  font-size: 11px;
  line-height: 1.6;
}

.diff-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 160px;
  color: var(--text-subtle);
  border: 1px dashed rgba(255, 255, 255, 0.25);
  border-radius: 10px;
  background: rgba(33, 33, 33, 0.4);
  font-family: -apple-system, "SF Pro Text", sans-serif;
  font-size: 13px;
}

.diff-media-card {
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  background: rgba(22, 22, 22, 0.85);
  box-shadow: 0 6px 22px rgba(0, 0, 0, 0.32);
  overflow: hidden;
}

.diff-media-thumb-btn {
  width: 100%;
  border: none;
  padding: 0;
  margin: 0;
  background: rgba(0, 0, 0, 0.22);
  cursor: zoom-in;
  display: block;
}

.diff-media-thumb {
  display: block;
  width: 100%;
  max-height: 220px;
  object-fit: contain;
  background: rgba(0, 0, 0, 0.5);
}

.diff-media-caption {
  display: flex;
  flex-direction: column;
  gap: 3px;
  padding: 8px 10px;
  border-top: 1px solid rgba(255, 255, 255, 0.12);
}

.diff-media-path {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 12px;
  color: var(--text-sec);
}

.diff-media-meta {
  font-size: 10px;
  color: var(--text-subtle);
}

.diff-media-lightbox {
  position: fixed;
  inset: 0;
  z-index: 1200;
  background: rgba(0, 0, 0, 0.78);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.diff-media-lightbox-inner {
  position: relative;
  width: min(88vw, 1200px);
  max-height: 88vh;
  border: 1px solid rgba(255, 255, 255, 0.18);
  border-radius: 10px;
  background: rgba(12, 12, 12, 0.96);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.diff-media-lightbox-close {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 28px;
  height: 28px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.28);
  background: rgba(18, 18, 18, 0.88);
  color: #f8fafc;
  font-size: 16px;
  line-height: 1;
  cursor: pointer;
}

.diff-media-full {
  width: 100%;
  max-height: 80vh;
  object-fit: contain;
  background: rgba(0, 0, 0, 0.66);
}

.diff-media-lightbox-path {
  padding: 8px 12px;
  font-size: 11px;
  color: var(--text-sec);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.diff-file-group {
  margin-bottom: 12px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  background: rgba(22, 22, 22, 0.85);
  box-shadow: 0 6px 22px rgba(0, 0, 0, 0.32);
  overflow: hidden;
}

.diff-file-group.is-focused {
  border-color: rgba(220, 224, 232, 0.5);
  box-shadow: 0 0 0 1px rgba(220, 224, 232, 0.28), 0 8px 24px rgba(0, 0, 0, 0.36);
}

.diff-file-group.is-focused .diff-file-header {
  background: rgba(40, 40, 40, 0.98);
}

.diff-file-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  background: rgba(30, 30, 30, 0.96);
  border-bottom: 1px solid rgba(255, 255, 255, 0.16);
}

.diff-file-title {
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

.diff-file-caret {
  color: var(--text-subtle);
  font-size: 12px;
  line-height: 1;
}

.diff-file-name {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-sec);
}

.diff-file-stats {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
}

.diff-file-lines {
  background: var(--color-background-surface-under, #000);
  overflow: hidden;
  font-family: var(--font-mono, ui-monospace, "SF Mono", "Menlo", Consolas, monospace);
}

.diff-line {
  display: grid;
  grid-template-columns: 48px 48px 16px minmax(0, 1fr);
  font-size: var(--diffs-font-size, 12px);
  line-height: var(--diffs-line-height, 1.8);
  border-top: 1px solid var(--color-border-light, #ffffff0a);
  transition: background-color 0.16s ease;
}

.diff-line:first-child {
  border-top: none;
}

.diff-line-num {
  width: 100%;
  padding: 0 6px;
  text-align: right;
  color: var(--color-text-foreground-tertiary, #ffffff80);
  user-select: none;
  font-variant-numeric: tabular-nums;
}

.diff-line-prefix {
  text-align: center;
  color: var(--color-text-foreground-tertiary, #ffffff80);
  user-select: none;
}

.diff-line-content {
  padding: 0 8px 0 10px;
  white-space: pre-wrap;
  word-break: break-word;
}

.diff-line.add {
  background: var(--color-editor-added, #40c9773b);
}

.diff-line.add .diff-line-prefix,
.diff-line.add .diff-line-content {
  color: var(--color-decoration-added, #40c977);
}

.diff-line.del {
  background: var(--color-editor-deleted, #fa423e3b);
}

.diff-line.del .diff-line-prefix,
.diff-line.del .diff-line-content {
  color: var(--color-decoration-deleted, #fa423e);
}

.diff-line.hunk {
  background: var(--color-editor-unchanged, #41414133);
}

.diff-line.hunk .diff-line-prefix,
.diff-line.hunk .diff-line-content {
  color: var(--color-text-foreground-secondary, #ffffffb3);
}

.diff-line.meta {
  background: var(--color-background-elevated-secondary, #ffffff08);
}

.diff-line.meta .diff-line-prefix,
.diff-line.meta .diff-line-content {
  color: var(--color-text-foreground-tertiary, #ffffff80);
}

.diff-line.is-focused-line {
  background: linear-gradient(90deg, rgba(212, 216, 224, 0.2) 0%, rgba(212, 216, 224, 0.12) 100%);
}

.diff-line.is-focused-line .diff-line-num,
.diff-line.is-focused-line .diff-line-prefix {
  color: rgba(241, 243, 247, 0.9);
}

.diff-line.is-focused-line .diff-line-content {
  color: #f8fafc;
}

.chat-messages-vue {
  height: 100%;
  overflow: auto;
  padding: 24px 20px 18px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  background: var(--color-background-surface-under, #000);
}

.chat-messages-vue.has-plan-pin {
  padding-top: 304px;
}

.chat-plan-pin {
  position: absolute;
  top: 10px;
  right: 12px;
  width: clamp(312px, 48%, 440px);
  max-width: calc(100% - 24px);
  z-index: 32;
  pointer-events: auto;
}

.chat-plan-pin-body {
  margin: 0;
  position: relative;
}

.chat-plan-pin-body.ran-plan-card-json .jr-card {
  border-color: var(--border-hover);
  background: linear-gradient(180deg, rgba(35, 35, 35, 0.96) 0%, rgba(20, 20, 20, 0.98) 100%);
  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.44);
}

.chat-plan-pin-body.ran-plan-card-json .jr-card-header {
  background: linear-gradient(180deg, rgba(46, 46, 46, 0.94) 0%, rgba(30, 30, 30, 0.96) 100%);
  padding-right: 46px;
}

.chat-plan-pin-body.ran-plan-card-json .jr-card-body {
  max-height: min(28vh, 220px);
}

.chat-plan-pin.done .chat-plan-pin-body.ran-plan-card-json .jr-card {
  border-color: var(--border-hover);
}

.chat-plan-pin-close {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 7;
  border: 1px solid var(--border-hover);
  background: color-mix(in srgb, var(--surface) 92%, #111 8%);
  color: var(--text);
  width: 28px;
  height: 28px;
  border-radius: 999px;
  font-size: 16px;
  font-weight: 600;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.46);
  transition: border-color var(--transition), color var(--transition), background var(--transition), transform var(--transition);
}

.chat-plan-pin-close:hover {
  border-color: var(--border-hover);
  color: var(--text);
  background: color-mix(in srgb, var(--hover) 84%, #1a1a1a 16%);
  transform: translateY(-1px);
}

@media (max-width: 960px) {
  .chat-messages-vue.has-plan-pin {
    padding-top: 320px;
  }

  .chat-plan-pin {
    width: calc(100% - 24px);
  }
}

@media (max-width: 640px) {
  .chat-messages-vue.has-plan-pin {
    padding-top: 292px;
  }

  .chat-plan-pin {
    top: 8px;
    right: 8px;
    width: calc(100% - 16px);
    max-width: calc(100% - 16px);
  }

  .chat-plan-pin-close {
    top: 8px;
    right: 8px;
  }
}

.chat-empty {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-subtle);
  font-size: 13px;
}

.chat-load-more {
  display: flex;
  justify-content: center;
  padding: 8px 0;
}

.chat-load-more-btn {
  background: var(--bg-secondary, #2a2a3e);
  color: var(--text-subtle, #888);
  border: 1px solid var(--border, #444);
  border-radius: 6px;
  padding: 4px 14px;
  font-size: 12px;
  cursor: pointer;
  transition: background 0.15s;
}

.chat-load-more-btn:hover {
  background: var(--bg-hover, #3a3a52);
  color: var(--text-primary, #ccc);
}

.chat-item {
  width: 100%;
  animation: codex-fade-in 0.25s ease forwards;
}

.chat-item.dialog {
  display: flex;
  align-items: flex-end;
  gap: 10px;
}

.chat-item.process {
  display: block;
  padding-left: 40px;
}

.chat-item-avatar {
  width: 30px;
  height: 30px;
  border-radius: 10px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 800;
  letter-spacing: 0.04em;
  flex-shrink: 0;
  color: var(--color-text-foreground, #fff);
  border: 1px solid var(--color-border, #ffffff14);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.08);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.chat-item-avatar-bot-icon {
  width: 15px;
  height: 15px;
  display: block;
}

.chat-item-avatar:hover {
  transform: scale(1.08);
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.35);
}

.chat-presence-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 4px;
  padding: 6px 0;
}

.chat-item-avatar-presence {
  background: var(--color-background-elevated-primary, #212121f5);
  animation: pulse 2s ease-in-out infinite;
}

.chat-status.chat-status-presence {
  height: 40px;
  padding: 0 18px;
  gap: 10px;
  border-color: var(--color-border, #ffffff14);
  background: var(--color-background-elevated-primary, #212121f5);
  backdrop-filter: blur(8px);
  color: var(--color-text-foreground, #fff);
  font-size: 13px;
  font-weight: 600;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);
}

.chat-status.chat-status-presence .status-dot {
  width: 10px;
  height: 10px;
}

.chat-status-spinner {
  width: 14px;
  height: 14px;
  flex-shrink: 0;
  animation: chat-status-spin 0.95s linear infinite;
}

.chat-status-spinner-track,
.chat-status-spinner-arc {
  stroke-width: 2.3;
}

.chat-status-spinner-track {
  stroke: rgba(255, 255, 255, 0.24);
}

.chat-status-spinner-arc {
  stroke: rgba(248, 250, 252, 0.96);
  stroke-linecap: round;
  stroke-dasharray: 18 60;
}

.chat-status.chat-status-presence .chat-status-meta {
  color: var(--color-text-foreground-tertiary, #ffffff80);
  font-size: 12px;
}

.chat-item-bubble {
  width: fit-content;
  max-width: min(84%, 980px);
  border: 1px solid var(--color-border, #ffffff14);
  border-radius: 16px;
  padding: 12px 14px;
  background: var(--color-background-elevated-primary, #212121f5);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.04);
  position: relative;
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.chat-item-bubble:hover {
  border-color: var(--color-border-heavy, #ffffff29);
  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.28), inset 0 1px 0 rgba(255, 255, 255, 0.06);
}

.chat-item.dialog.role-user {
  justify-content: flex-end;
  flex-direction: row-reverse;
}

.chat-item.dialog.role-user .chat-item-avatar {
  background: linear-gradient(180deg, rgba(72, 72, 72, 0.96) 0%, rgba(48, 48, 48, 0.98) 100%);
  border-color: rgba(228, 228, 228, 0.32);
}

.chat-item.dialog.role-assistant .chat-item-avatar {
  background: var(--color-background-elevated-primary-opaque, #282828);
  border-color: var(--color-border, #ffffff14);
}

.chat-item.dialog.role-assistant {
  justify-content: flex-start;
}

.chat-item.dialog.role-assistant .chat-item-bubble {
  max-width: 100%;
  width: 100%;
  background: linear-gradient(180deg, rgba(26, 26, 26, 0.62) 0%, rgba(18, 18, 18, 0.48) 100%);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-left: 2px solid var(--assistant-accent);
  border-radius: 12px;
  padding: 10px 14px;
  box-shadow: 0 3px 14px rgba(0, 0, 0, 0.24), inset 0 1px 0 rgba(255, 255, 255, 0.04);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.chat-item.dialog.role-assistant .chat-item-bubble:hover {
  border-color: rgba(255, 255, 255, 0.18);
  border-left-color: var(--assistant-accent-strong);
  box-shadow: 0 5px 18px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.06);
  background: linear-gradient(180deg, rgba(32, 32, 32, 0.7) 0%, rgba(20, 20, 20, 0.56) 100%);
}

.chat-item.dialog.role-user .chat-item-bubble {
  background: var(--color-background-elevated-secondary-opaque, #212121);
  border-color: var(--color-border, #ffffff14);
  max-width: min(72%, 820px);
  margin-left: auto;
}

.chat-item.dialog.role-assistant .chat-item-bubble::after {
  display: none;
}

.chat-item.dialog.role-user .chat-item-bubble::after {
  display: none;
}

.chat-item.dialog .chat-item-role,
.chat-item.dialog .chat-item-time,
.chat-item.dialog .chat-item-body,
.chat-item.dialog .chat-item-foot,
.chat-item.dialog .chat-item-meta {
  color: #f8fafc;
}

.chat-item.dialog .chat-item-status {
  color: #f8fafc;
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.2);
}

.chat-item.dialog .chat-item-code {
  background: rgba(0, 0, 0, 0.34);
  border-color: rgba(255, 255, 255, 0.24);
  color: #f8fafc;
}

.chat-process-line {
  width: min(78%, 860px);
  padding: 4px 0 6px 10px;
  border-left: 2px solid var(--color-border, #ffffff14);
  border-radius: 0 7px 7px 0;
  background: var(--color-background-elevated-secondary, #ffffff08);
  margin: 2px 0;
  transition: background 0.2s ease, border-color 0.2s ease;
}

.chat-process-line:hover {
  background: var(--color-background-button-secondary-hover, #ffffff14);
  border-left-color: var(--color-border-heavy, #ffffff29);
}

.chat-item.process.kind-thinking .chat-process-line {
  border-left-style: dashed;
  border-left-color: var(--assistant-accent);
  background: var(--assistant-surface);
}

.chat-item.process.kind-command .chat-process-line {
  width: min(86%, 980px);
  padding: 2px 0 4px;
  border-left-color: transparent;
  background: transparent;
  border-radius: 0;
}

.chat-item.process.kind-command .chat-process-line:hover {
  background: transparent;
  border-left-color: transparent;
}

.ran-command-card {
  display: flex;
  flex-direction: column;
  border: 1px solid rgba(129, 131, 142, 0.2);
  border-radius: 0.375rem;
  overflow: hidden;
  color: var(--text-sec);
  background: rgba(255, 255, 255, 0.01);
  font-family: "SF Mono", "Monaco", "Menlo", "Courier", monospace;
  font-size: 12px;
}

.ran-command-card__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.25rem 0.5rem;
  margin-bottom: 0.25rem;
  border-bottom: 1px solid rgba(129, 131, 142, 0.25);
}

.ran-command-card__status {
  opacity: 0.6;
}

.ran-command-card__main-row {
  display: flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.25rem 0.5rem;
  min-height: 1.75rem;
}

.ran-command-card__icon {
  flex-shrink: 0;
  width: 0.875rem;
  height: 0.875rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.ran-command-card__icon--spinning {
  animation: ran-command-spin 1s linear infinite;
}

.ran-command-card__icon--running {
  color: var(--vscode-button-background, var(--success));
}

.ran-command-card__icon--done {
  opacity: 0.5;
  color: var(--text-sec);
}

.ran-command-card__icon--error {
  color: var(--error);
}

.ran-command-card__icon--waiting {
  color: var(--warning);
}

.ran-command-card__title {
  flex: 1 1 0%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.ran-command-card__details {
  transition: max-height 0.15s ease-in-out, opacity 0.15s ease-in-out, margin-top 0.15s ease-in-out;
  border-top: 1px solid rgba(129, 131, 142, 0.1);
}

.ran-command-card__details--open {
  max-height: 24rem;
  overflow-y: auto;
  opacity: 1;
  margin-top: 0.125rem;
}

.ran-command-card__details--closed {
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  margin-top: 0;
  border-top-color: transparent;
}

.ran-command-card__output {
  margin: 0;
  padding: 0.45rem 0.6rem;
  border-radius: 0.25rem;
  background: rgba(129, 131, 142, 0.05);
  color: var(--text-sec);
  font-family: "SF Mono", "Monaco", "Menlo", "Courier", monospace;
  font-size: 11px;
  line-height: 1.4;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
  max-height: 22rem;
  overflow: auto;
}

.ran-command-card__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom-left-radius: 0.25rem;
  border-bottom-right-radius: 0.25rem;
  border-top: 1px solid rgba(129, 131, 142, 0.25);
  padding: 0.25rem 0.5rem 0.25rem 0.25rem;
  font-size: 12px;
}

.ran-command-card__auto-exec {
  opacity: 0.7;
}

.ran-command-card__footer-right {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.ran-command-card__cancel-btn {
  opacity: 0.7;
}

.ran-command-card__exit-code {
  opacity: 0.6;
}

@keyframes ran-command-spin {
  to {
    transform: rotate(360deg);
  }
}

.ran-plan-card-json {
  position: relative;
}

.ran-plan-card-json .jr-card {
  border: 1px solid var(--border-hover);
  border-radius: 12px;
  overflow: hidden;
  color: var(--text);
  background: var(--chat-system-bg);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04);
}

.ran-plan-card-json.is-done .jr-card {
  border-color: var(--border-hover);
}

.ran-plan-card-json .jr-card-header {
  padding: 8px 48px 7px 10px;
  border-bottom: 1px solid var(--border);
  background: var(--assistant-surface);
}

.ran-plan-card-json .jr-card-title {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--text-muted);
}

.ran-plan-card-json .jr-card-desc {
  color: var(--text-subtle);
  font-size: 11px;
  margin-top: 3px;
}

.ran-plan-card-json .jr-card-body {
  padding: 12px 14px 13px;
  max-height: min(56vh, 680px);
  overflow: auto;
  gap: 10px;
  background: transparent;
}

.ran-plan-card-json .jr-stack.jr-stack-row {
  align-items: center;
}

.ran-plan-card-json .jr-stack.jr-stack-row > .jr-root {
  margin: 0;
}

.ran-plan-card-json .jr-markdown {
  margin: 0;
}

.ran-plan-card-json .jr-markdown.chat-item-markdown > p:first-child {
  font-weight: 600;
  color: var(--text);
}

.ran-plan-card-json .jr-markdown.chat-item-markdown h1,
.ran-plan-card-json .jr-markdown.chat-item-markdown h2,
.ran-plan-card-json .jr-markdown.chat-item-markdown h3,
.ran-plan-card-json .jr-markdown.chat-item-markdown h4 {
  color: var(--text);
}

.ran-plan-card-json .jr-markdown.chat-item-markdown ol,
.ran-plan-card-json .jr-markdown.chat-item-markdown ul {
  padding-left: 1.35em;
}

.ran-plan-card-json .jr-markdown.chat-item-markdown li {
  line-height: 1.62;
}

.ran-plan-card-json .jr-markdown.chat-item-markdown li + li {
  margin-top: 7px;
}

.ran-plan-card-json .jr-markdown.chat-item-markdown li::marker {
  color: var(--text-muted);
}

.ran-plan-card-json .jr-markdown.chat-item-markdown .chat-md-inline-code {
  border-color: var(--border-hover);
  background: var(--elevated);
  color: var(--text-sec);
}

.ran-plan-card-json .jr-markdown.chat-item-markdown .chat-md-code {
  border-color: var(--border-hover);
  background: #1e1e1e;
}

.ran-plan-card-json .jr-badge-primary {
  background: var(--selected);
  color: var(--text-sec);
  border: 1px solid var(--border-hover);
}

.ran-plan-card-json .jr-badge-success {
  background: var(--selected);
  color: var(--text);
  border: 1px solid var(--border-hover);
}

.ran-plan-card-json__copy {
  position: absolute;
  top: 7px;
  right: 10px;
  width: 28px;
  height: 28px;
  border: 1px solid var(--border-hover);
  border-radius: 8px;
  background: var(--hover);
  color: var(--text-sec);
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: color 0.18s ease, border-color 0.18s ease, background 0.18s ease, transform 0.18s ease;
}

.ran-plan-card-json__copy:hover:not(:disabled) {
  color: var(--text);
  border-color: var(--border-hover);
  background: var(--selected);
  transform: translateY(-1px);
}

.ran-plan-card-json__copy:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.ran-plan-card-json__copy-icon {
  width: 13px;
  height: 13px;
}

.chat-item.process.kind-tool .chat-process-line {
  border-left-color: var(--color-accent-purple, #ad7bf9);
  background: rgba(173, 123, 249, 0.06);
}

.chat-item.process.kind-file .chat-process-line {
  width: min(94%, 1040px);
  padding: 3px 0 4px 10px;
  border-left-color: var(--color-accent-orange, #fb6a22);
  background: rgba(251, 106, 34, 0.06);
}

.chat-item.process.kind-plan .chat-process-line {
  width: min(86%, 980px);
  padding: 2px 0 4px;
  border-left-color: transparent;
  background: transparent;
  border-radius: 0;
}

.chat-item.process.kind-plan .chat-process-line:hover {
  background: transparent;
  border-left-color: transparent;
}

.chat-item.process.kind-approval .chat-process-line {
  border-left-color: var(--color-accent-yellow, #ffd240);
  background: rgba(255, 210, 64, 0.06);
}

.chat-item.process.kind-error .chat-process-line {
  border-left-color: var(--color-accent-red, #ff6764);
  background: rgba(255, 103, 100, 0.06);
}

.chat-item.process.kind-error .chat-process-text,
.chat-item.process.kind-error .chat-process-role {
  color: #f8fafc;
}

.chat-item-head {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  padding-bottom: 6px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);
}

.chat-item-role {
  font-size: 10px;
  font-weight: 700;
  color: var(--color-text-foreground-tertiary, #ffffff80);
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.chat-item-status {
  font-size: 10px;
  color: var(--text-sec);
  background: rgba(255, 255, 255, 0.15);
  border: 1px solid rgba(255, 255, 255, 0.28);
  border-radius: 999px;
  padding: 1px 8px;
}

.chat-process-head {
  display: flex;
  align-items: center;
  gap: 5px;
  margin-bottom: 2px;
}

.chat-process-role {
  font-size: 9px;
  font-weight: 700;
  color: var(--color-text-foreground-tertiary, #ffffff80);
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.chat-process-status {
  font-size: 9px;
  color: var(--color-text-foreground-tertiary, #ffffff80);
  background: var(--color-background-elevated-secondary, #ffffff08);
  border-radius: 4px;
  padding: 1px 5px;
}

.chat-process-time {
  color: var(--color-text-foreground-tertiary, #ffffff80);
  font-size: 8px;
  font-variant-numeric: tabular-nums;
  line-height: 1;
}

.chat-process-head-file {
  gap: 4px;
  margin-bottom: 0;
  min-width: 0;
}

.chat-process-kind-icon,
.chat-process-state-icon {
  width: 12px;
  height: 12px;
  flex-shrink: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.chat-process-kind-icon {
  color: rgba(255, 255, 255, 0.68);
}

.chat-process-kind-icon svg,
.chat-process-state-icon svg {
  width: 12px;
  height: 12px;
}

.chat-process-state-icon.is-saved {
  color: #7fd7a2;
}

.chat-process-state-icon.is-editing {
  color: #f7c36a;
}

.chat-process-file-inline {
  min-width: 0;
  flex: 1;
  font-family: var(--font-mono, "SF Mono", "Menlo", monospace);
  font-size: 10px;
  line-height: 1.2;
  color: var(--color-text-foreground-secondary, #ffffffb3);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.chat-process-copy-btn {
  width: 15px;
  height: 15px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 4px;
  background: rgba(255, 255, 255, 0.06);
  color: var(--color-text-foreground-secondary, #ffffffb3);
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: color 0.18s ease, border-color 0.18s ease, background 0.18s ease;
}

.chat-process-copy-btn:hover:not(:disabled) {
  color: var(--color-text-foreground, #fff);
  border-color: rgba(255, 255, 255, 0.36);
  background: rgba(255, 255, 255, 0.12);
}

.chat-process-copy-btn:disabled {
  opacity: 0.45;
  cursor: not-allowed;
}

.chat-process-copy-icon {
  width: 9px;
  height: 9px;
}

.chat-item-spacer {
  flex: 1;
}

.chat-item-time {
  color: #f8fafc;
  font-size: 10px;
  font-variant-numeric: tabular-nums;
  opacity: 0.66;
}

.chat-item-body {
  margin: 0;
  font-family: inherit;
  font-size: 13.5px;
  color: var(--color-text-foreground, #fff);
  line-height: 1.7;
  word-break: break-word;
  letter-spacing: 0.01em;
}

.chat-item-plain {
  white-space: pre-wrap;
}

.chat-item-markdown {
  white-space: normal;
  display: block;
}

.chat-item-markdown>* {
  margin: 0;
}

.chat-item-markdown>*+* {
  margin-top: 10px;
}

.chat-item-markdown h1,
.chat-item-markdown h2,
.chat-item-markdown h3,
.chat-item-markdown h4 {
  font-weight: 700;
  letter-spacing: 0.01em;
  line-height: 1.45;
}

.chat-item-markdown h1 {
  font-size: 16px;
}

.chat-item-markdown h2 {
  font-size: 15px;
}

.chat-item-markdown h3,
.chat-item-markdown h4 {
  font-size: 14px;
}

.chat-item-markdown ul,
.chat-item-markdown ol {
  padding-left: 1.2em;
}

.chat-item-markdown li {
  line-height: 1.62;
}

.chat-item-markdown li+li {
  margin-top: 5px;
}

.chat-item-markdown li::marker {
  color: rgba(229, 231, 235, 0.72);
}

.chat-item-markdown strong {
  color: #f8fafc;
  font-weight: 700;
}

.chat-item-markdown em {
  font-style: italic;
  color: #fff;
}

.chat-item-markdown .chat-md-link {
  color: #93c5fd;
  text-decoration: underline;
  text-decoration-color: rgba(147, 197, 253, 0.65);
  text-underline-offset: 2px;
  transition: color 180ms ease, text-decoration-color 180ms ease;
}

.chat-item-markdown .chat-md-link:hover {
  color: #bfdbfe;
  text-decoration-color: rgba(191, 219, 254, 0.92);
}

.chat-item-markdown .chat-md-inline-code {
  display: inline-block;
  padding: 2px 7px;
  border-radius: 6px;
  border: 1px solid var(--color-border, #ffffff14);
  background: var(--color-background-elevated-secondary-opaque, #212121);
  color: #e5e7eb;
  font-family: "SF Mono", "Menlo", monospace;
  font-size: 0.88em;
  line-height: 1.5;
  vertical-align: baseline;
  transition: border-color 0.2s ease, background 0.2s ease;
}

.chat-item-markdown .chat-md-inline-code:hover {
  border-color: var(--color-border-heavy, #ffffff29);
  background: var(--color-background-elevated-primary-opaque, #282828);
}

.chat-item-markdown .chat-md-inline-code.is-file-ref {
  cursor: pointer;
  padding: 0;
  border: none;
  border-radius: 0;
  background: none;
  color: #93c5fd;
  font-size: 1em;
  font-family: inherit;
  text-decoration: underline;
  text-decoration-color: rgba(147, 197, 253, 0.65);
  text-underline-offset: 2px;
}

.chat-item-markdown .chat-md-inline-code.is-file-ref:hover {
  color: #bfdbfe;
  background: none;
  text-decoration-color: rgba(191, 219, 254, 0.92);
}

.chat-item-markdown .chat-md-code {
  margin: 4px 0;
  padding: 14px 12px;
  border-radius: 10px;
  border: 1px solid #3c3c3c;
  background: #1e1e1e;
  --code-token-comment: #6a9955;
  --code-token-string: #ce9178;
  --code-token-number: #b5cea8;
  --code-token-constant: #4fc1ff;
  --code-token-keyword: #c586c0;
  --code-token-function: #dcdcaa;
  --code-token-operator: #d4d4d4;
  overflow-x: hidden;
  white-space: pre-wrap;
  position: relative;
  box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.15);
}

.chat-item-markdown .chat-md-code code {
  display: block;
  color: #d4d4d4;
  font-family: "SF Mono", "Menlo", monospace;
  font-size: 12.5px;
  line-height: 1.58;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
}

.chat-item-markdown .chat-md-code code .chat-md-token-comment {
  color: var(--code-token-comment);
  font-style: italic;
}

.chat-item-markdown .chat-md-code code .chat-md-token-string {
  color: var(--code-token-string);
}

.chat-item-markdown .chat-md-code code .chat-md-token-number {
  color: var(--code-token-number);
}

.chat-item-markdown .chat-md-code code .chat-md-token-constant {
  color: var(--code-token-constant);
}

.chat-item-markdown .chat-md-code code .chat-md-token-keyword {
  color: var(--code-token-keyword);
  font-weight: 600;
}

.chat-item-markdown .chat-md-code code .chat-md-token-function {
  color: var(--code-token-function);
}

.chat-item-markdown .chat-md-code code .chat-md-token-operator {
  color: var(--code-token-operator);
}

.chat-item-markdown .chat-md-code-lang {
  position: absolute;
  right: 8px;
  top: 8px;
  padding: 2px 8px;
  border-radius: 6px;
  border: 1px solid #3c3c3c;
  background: #252526;
  color: #9da7b3;
  font-size: 9px;
  font-family: "SF Mono", "Menlo", monospace;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  backdrop-filter: blur(4px);
}

.chat-item-markdown .chat-md-quote {
  padding-left: 10px;
  border-left: 2px solid rgba(209, 213, 219, 0.56);
  color: #e5e7eb;
  opacity: 0.94;
}

.chat-item-markdown .chat-md-callout {
  margin: 6px 0;
  padding: 10px 12px;
  border-radius: 10px;
  border-left-width: 3px;
  border-left-style: solid;
  border-left-color: rgba(148, 163, 184, 0.7);
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  border-right: 1px solid rgba(255, 255, 255, 0.1);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.03);
}

.chat-item-markdown .chat-md-callout-title {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-bottom: 6px;
  color: #e5e7eb;
}

.chat-item-markdown .chat-md-callout-body {
  color: rgba(248, 250, 252, 0.92);
}

.chat-item-markdown .chat-md-callout.chat-md-callout-tip {
  border-left-color: rgba(74, 222, 128, 0.8);
}

.chat-item-markdown .chat-md-callout.chat-md-callout-important {
  border-left-color: rgba(250, 204, 21, 0.82);
}

.chat-item-markdown .chat-md-callout.chat-md-callout-warning,
.chat-item-markdown .chat-md-callout.chat-md-callout-caution {
  border-left-color: rgba(251, 146, 60, 0.82);
}

.chat-item-markdown .chat-md-callout.chat-md-callout-note {
  border-left-color: rgba(148, 163, 184, 0.82);
}

.chat-item-markdown .chat-md-table-wrap {
  width: 100%;
  overflow-x: auto;
}

.chat-item-markdown .chat-md-table {
  width: 100%;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 4px 0;
}

.chat-item-markdown .chat-md-table th,
.chat-item-markdown .chat-md-table td {
  padding: 7px 10px;
  border: 1px solid rgba(255, 255, 255, 0.14);
  font-size: 12.5px;
  line-height: 1.55;
}

.chat-item-markdown .chat-md-table th {
  background: rgba(255, 255, 255, 0.06);
  color: #f3f4f6;
  font-weight: 700;
}

.chat-item-markdown .chat-md-table td {
  color: #e5e7eb;
}

.chat-item-markdown .chat-md-table th[data-align="center"],
.chat-item-markdown .chat-md-table td[data-align="center"] {
  text-align: center;
}

.chat-item-markdown .chat-md-table th[data-align="right"],
.chat-item-markdown .chat-md-table td[data-align="right"] {
  text-align: right;
}

.chat-item-markdown .chat-md-divider {
  border: none;
  border-top: 1px solid rgba(255, 255, 255, 0.34);
}

.chat-item-code {
  background: rgba(0, 0, 0, 0.35);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  padding: 8px 10px;
  font-family: "SF Mono", "Menlo", monospace;
  font-size: 12px;
  line-height: 1.5;
}

.chat-process-text {
  margin: 0;
  white-space: pre-wrap;
  font-family: var(--font-mono, "SF Mono", "Menlo", monospace);
  font-size: 11.5px;
  color: var(--color-text-foreground, #fff);
  line-height: 1.45;
  word-break: break-word;
}

.chat-process-code {
  display: block;
  background: var(--color-token-terminal-background, rgba(0, 0, 0, 0.45));
  border: 1px solid var(--color-token-terminal-border, rgba(255, 255, 255, 0.1));
  border-radius: 12px;
  padding: 8px 12px;
  font-family: var(--font-mono, ui-monospace, "SF Mono", "Menlo", Consolas, monospace);
  font-size: 12px;
  line-height: 1.4;
  color: var(--color-token-terminal-foreground, rgba(255, 255, 255, 0.88));
}

.chat-process-terminal {
  max-height: 36vh;
  overflow: auto;
  background: none !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  font-family: var(--font-mono, ui-monospace, "SF Mono", "Menlo", Consolas, monospace);
  font-size: 11px;
  line-height: 1.4;
  color: var(--text-sec, #ffffffb3);
}

.chat-process-output {
  margin-top: 4px;
  max-height: 36vh;
  overflow: auto;
  background: var(--color-token-terminal-background, rgba(0, 0, 0, 0.45));
  border: 1px solid var(--color-token-terminal-border, rgba(255, 255, 255, 0.1));
  border-radius: 12px;
  padding: 8px 12px;
  font-family: var(--font-mono, "SF Mono", "Menlo", monospace);
  font-size: 12px;
  line-height: 1.4;
  color: var(--color-token-terminal-foreground, rgba(255, 255, 255, 0.88));
}

.chat-process-meta {
  margin-top: 3px;
  color: var(--color-text-foreground-secondary, #ffffffb3);
  font-size: 10.5px;
  font-family: var(--font-mono, "SF Mono", "Menlo", monospace);
}

.chat-file-path {
  margin-top: 4px;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
  line-height: 1.35;
}

.chat-process-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.chat-process-foot {
  margin-top: 4px;
  font-size: 11px;
  font-family: var(--font-mono, "SF Mono", "Menlo", monospace);
  color: var(--color-text-foreground-secondary, #ffffffb3);
}

.chat-item-meta {
  color: var(--text-sec);
  font-size: 12px;
}

.chat-item-truncate {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.tool-call-name {
  margin: 0;
  flex: 1;
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--color-accent-purple, #ad7bf9);
  font-weight: 600;
}

.tool-call-time {
  margin: 0;
  flex-shrink: 0;
  color: var(--color-text-foreground-tertiary, #ffffff80);
}

.tool-preview {
  margin-top: 6px;
  color: var(--color-text-foreground-tertiary, #ffffff80);
}

.chat-item-foot {
  margin-top: 6px;
  font-size: 10px;
  letter-spacing: 0.02em;
  color: var(--text-muted);
}

.chat-attachment-list {
  margin-top: 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.chat-attachment-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  background: var(--chat-pill-bg);
}

.chat-attachment-pill.has-image {
  flex-direction: column;
  align-items: flex-start;
  border-radius: 10px;
  padding: 6px 8px;
  cursor: zoom-in;
}

.attachment-kind {
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.14);
  color: #f8fafc;
  padding: 1px 6px;
  font-size: 9px;
  letter-spacing: 0.06em;
  font-weight: 700;
}

.attachment-name {
  max-width: 320px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: #f8fafc;
}

.chat-attachment-image {
  max-width: 320px;
  max-height: 240px;
  object-fit: contain;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.26);
  transition: transform 0.16s ease, border-color 0.16s ease;
}

.chat-attachment-pill.has-image:hover .chat-attachment-image {
  transform: scale(1.03);
  border-color: rgba(255, 255, 255, 0.4);
}

.chat-attachment-hover-preview {
  position: fixed;
  z-index: 1200;
  width: min(70vw, 760px);
  max-height: min(82vh, 720px);
  padding: 8px;
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.28);
  background: rgba(8, 8, 10, 0.88);
  box-shadow: 0 12px 36px rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  pointer-events: auto;
  overflow: auto;
  animation: chat-attachment-preview-enter 0.12s ease-out;
  transition: width 0.12s ease, max-height 0.12s ease;
}

.chat-attachment-preview-zoom-controls {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 2;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.chat-attachment-preview-zoom-btn {
  width: 28px;
  height: 28px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.34);
  background: rgba(8, 8, 10, 0.8);
  color: #f8fafc;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: 700;
  line-height: 1;
  cursor: pointer;
}

.chat-attachment-preview-zoom-btn:hover {
  border-color: rgba(255, 255, 255, 0.5);
  background: rgba(20, 20, 24, 0.92);
}

.chat-attachment-preview-zoom-btn:focus-visible {
  outline: 2px solid rgba(148, 197, 255, 0.8);
  outline-offset: 1px;
}

.chat-attachment-preview-zoom-btn.is-minus {
  cursor: zoom-out;
}

.chat-attachment-preview-zoom-btn.is-plus {
  cursor: zoom-in;
}

.chat-attachment-preview-zoom-btn.is-reset {
  width: auto;
  min-width: 40px;
  padding: 0 8px;
  font-size: 11px;
  letter-spacing: 0.02em;
}

.chat-attachment-preview-zoom-btn:disabled {
  opacity: 0.46;
  cursor: default;
}

.chat-attachment-preview-zoom-btn:disabled:hover {
  border-color: rgba(255, 255, 255, 0.34);
  background: rgba(8, 8, 10, 0.8);
}

.chat-attachment-hover-preview img {
  width: 100%;
  max-height: none;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
  display: block;
}

@keyframes chat-attachment-preview-enter {
  from {
    opacity: 0;
    transform: translateY(4px) scale(0.97);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@media (prefers-reduced-motion: reduce) {
  .chat-attachment-image,
  .chat-attachment-hover-preview {
    transition: none !important;
    animation: none !important;
  }
}

.attachment-remove {
  border: none;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 13px;
  line-height: 1;
  padding: 0 2px;
}

.cmd-output {
  margin-top: 8px;
  max-height: 220px;
  overflow: auto;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  padding: 8px;
  font-family: "Menlo", "SF Mono", monospace;
  font-size: 12px;
}

.chat-input-vue {
  border-top: 1px solid var(--border);
  padding: 12px 14px;
  background: linear-gradient(180deg, rgba(26, 26, 26, 0.96) 0%, rgba(14, 14, 14, 0.98) 100%);
  backdrop-filter: blur(8px);
  transition: border-color var(--transition), box-shadow var(--transition);
}

.chat-input-vue.drop-active {
  border-top-color: rgba(255, 255, 255, 0.46);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.32);
}

.chat-input-vue.file-drop-target-active {
  border-top-color: rgba(255, 255, 255, 0.46);
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.32);
}

.composer-drop-hint {
  position: absolute;
  top: 8px;
  right: 14px;
  z-index: 2;
  pointer-events: none;
  font-size: 11px;
  line-height: 1.3;
  font-weight: 600;
  color: #e7f6ff;
  background: rgba(22, 69, 101, 0.8);
  border: 1px solid rgba(132, 200, 255, 0.65);
  border-radius: 999px;
  padding: 4px 10px;
}

.chat-input-row-vue,
#input-row {
  display: flex;
  gap: 10px;
  align-items: flex-end;
}

.composer-action-stack {
  display: inline-flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
  flex-shrink: 0;
}

.composer-top-actions {
  display: inline-flex;
  align-items: center;
  justify-content: flex-end;
  gap: 6px;
  min-height: 24px;
}

.composer-compact-btn {
  width: 24px;
  height: 24px;
  padding: 0;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.34);
  background: rgba(33, 33, 33, 0.92);
  color: var(--text-sec);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: border-color var(--transition), background var(--transition), color var(--transition);
}

.composer-compact-btn:hover:not(:disabled) {
  border-color: rgba(255, 255, 255, 0.52);
  color: var(--text);
}

.composer-compact-btn:disabled {
  opacity: 0.45;
  cursor: default;
}

.composer-compact-btn.loading {
  border-color: rgba(255, 255, 255, 0.52);
  color: var(--text);
}

.composer-compact-icon {
  width: 14px;
  height: 14px;
}

.composer-compact-btn.loading .composer-compact-icon {
  animation: composer-compact-spin 0.9s linear infinite;
}

@keyframes composer-compact-spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

.composer-token-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  background: rgba(33, 33, 33, 0.9);
  color: var(--text-sec);
  font-size: 11px;
  line-height: 1.2;
  cursor: help;
}

.composer-token-chip.loading {
  border-color: rgba(255, 255, 255, 0.48);
  color: var(--text);
}

.composer-skill-selector {
  margin-bottom: 8px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-height: 32px;
}

.composer-skill-selector-head {
  display: flex;
  align-items: center;
  gap: 6px;
}

.composer-skill-selector-title {
  color: var(--text-subtle);
  font-size: 11px;
  line-height: 1.2;
}

.composer-skill-selector-btn {
  border: 1px solid rgba(255, 255, 255, 0.35);
  background: rgba(33, 33, 33, 0.75);
  color: var(--text-sec);
  border-radius: 999px;
  padding: 1px 8px;
  font-size: 11px;
  line-height: 1.2;
  cursor: pointer;
}

.composer-skill-selector-btn:disabled {
  cursor: default;
  opacity: 0.45;
}

.composer-skill-selector-list {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 6px;
  max-height: 88px;
  overflow: auto;
}

.composer-skill-selector-item {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  max-width: min(520px, 100%);
  padding: 3px 9px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.35);
  background: rgba(33, 33, 33, 0.92);
  color: var(--text-sec);
  font-size: 11px;
  line-height: 1.2;
  cursor: pointer;
  transition: border-color var(--transition), background var(--transition), color var(--transition);
}

.composer-skill-selector-item:hover {
  border-color: rgba(255, 255, 255, 0.52);
}

.composer-skill-selector-item.selected {
  border-color: rgba(255, 255, 255, 0.72);
  background: rgba(255, 255, 255, 0.14);
  color: var(--text);
}

.composer-skill-selector-item.trigger {
  border-color: rgba(255, 255, 255, 0.46);
  color: #e5e7eb;
}

.composer-skill-selector-item.force {
  border-color: rgba(248, 113, 113, 0.54);
  color: #ffd4d4;
}

.composer-skill-selector-item.explicit {
  border-color: rgba(167, 139, 250, 0.56);
  color: #e5d7ff;
}

.composer-skill-selector-item-name {
  color: var(--text);
  font-weight: 600;
  word-break: break-all;
}

.composer-skill-selector-item-reason {
  color: inherit;
  opacity: 0.9;
  word-break: break-all;
}

.composer-skill-selector-empty {
  color: var(--text-subtle);
  font-size: 11px;
  line-height: 1.2;
}

.chat-input-row-vue textarea,
#chatInput {
  flex: 1;
  background: rgba(33, 33, 33, 0.8);
  color: var(--text-sec);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 10px;
  padding: 9px 11px;
  resize: vertical;
}

#chatInput {
  max-height: 160px;
  line-height: 1.55;
  min-height: 38px;
  outline: none;
}

#chatInput::placeholder {
  color: var(--text-subtle);
}

#chatInput:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.14);
}

#btnAttach {
  min-width: 72px;
  height: 36px;
  border-radius: 10px;
  background: rgba(33, 33, 33, 0.75);
  border: 1px solid rgba(255, 255, 255, 0.35);
  color: var(--text-sec);
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: border-color var(--transition), background var(--transition), color var(--transition);
  flex-shrink: 0;
  padding: 0 10px;
}

#btnAttach:hover:not(:disabled) {
  background: rgba(56, 56, 56, 0.95);
  color: var(--text);
  border-color: var(--border-hover);
}

#btnSend {
  width: 48px;
  height: 48px;
  padding: 0;
  border-radius: 999px;
  background: #f8fafc;
  border: 1px solid rgba(255, 255, 255, 0.95);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.22);
  color: #000;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

#btnSend:hover:not(:disabled) {
  background: #ffffff;
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.26);
}

#btnSend:active:not(:disabled) {
  transform: translateY(1px);
}

#btnSend.btn-stop {
  background: #f8fafc;
}

#btnSend:not(.btn-stop):disabled {
  opacity: 1;
  background: #ffffff4d;
  border-color: rgba(255, 255, 255, 0.9);
  color: #ffffff;
  box-shadow: none;
}

.btn-send-icon {
  width: 21px;
  height: 21px;
}

.btn-stop-icon {
  width: 15px;
  height: 15px;
  border-radius: 3px;
  background: currentColor;
}

.composer-attachments {
  margin-bottom: 10px;
}

.data-list-vue {
  display: grid;
  gap: 10px;
}

.data-card-vue {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: var(--surface);
  padding: 10px;
  display: grid;
  gap: 6px;
}

.data-row-vue {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  font-size: 12px;
}

.data-row-vue strong {
  color: var(--text-muted);
  font-weight: 600;
}

.data-row-vue span {
  text-align: right;
  color: var(--text);
  word-break: break-word;
}

.data-actions-vue {
  margin-top: 6px;
  display: flex;
  justify-content: flex-end;
}

.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.modal-box {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px 24px;
  min-width: 380px;
  max-width: 500px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.modal-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 12px;
}

.modal-input {
  width: 100%;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 8px 12px;
  color: var(--text);
  font-size: 13px;
  font-family: "Menlo", monospace;
  outline: none;
  box-sizing: border-box;
  transition: border-color var(--transition);
}

.modal-input:focus {
  border-color: var(--primary);
}

.modal-btns {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 14px;
}

@keyframes pulse {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }
}

.chat-messages-vue {
  scrollbar-color: transparent transparent;
}

.chat-messages-vue:hover {
  scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
}

.chat-messages-vue::-webkit-scrollbar {
  width: 4px;
}

.chat-messages-vue::-webkit-scrollbar-track {
  background: transparent;
}

.chat-messages-vue::-webkit-scrollbar-thumb {
  background: transparent;
  border-radius: 999px;
}

.chat-messages-vue:hover::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
}

#diff-content::-webkit-scrollbar,
.cmd-output::-webkit-scrollbar {
  width: 5px;
}

#diff-content::-webkit-scrollbar-track {
  background: transparent;
}

#diff-content::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

@keyframes chat-status-spin {
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: reduce) {
  .chat-running-spinner,
  .chat-status-spinner {
    animation: none;
  }
}

/* -- Utility classes replacing inline styles -- */

.btn-toolbar-sm {
  font-size: 11px;
  padding: 4px 10px;
}

.launch-agent-icon-btn {
  width: 30px;
  height: 30px;
  padding: 0;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.launch-agent-icon-btn svg {
  width: 15px;
  height: 15px;
  display: block;
}

.chat-toolbar-icon-btn {
  width: 30px;
  height: 30px;
  padding: 0 !important;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.chat-toolbar-icon-btn svg {
  width: 16px;
  height: 16px;
  display: block;
}

.modal-input-row {
  display: flex;
  gap: 8px;
  align-items: center;
}

.modal-input-flex {
  flex: 1;
}

.modal-browse-btn {
  flex-shrink: 0;
  font-size: 11px;
  padding: 6px 10px;
}

.settings-action-row {
  margin-top: 12px;
}

.settings-log-card {
  gap: 8px;
}

.settings-prompt-card {
  gap: 8px;
}

.settings-prompt-desc {
  font-size: 12px;
  color: var(--text-muted);
}

.settings-prompt-textarea {
  width: 100%;
  min-height: 120px;
  resize: vertical;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  background: rgba(33, 33, 33, 0.7);
  color: var(--text-pri);
  font-family: "Menlo", "Consolas", monospace;
  font-size: 12px;
  line-height: 1.55;
  padding: 10px 12px;
}

.settings-prompt-textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2);
}

.settings-prompt-notice {
  font-size: 12px;
  color: var(--text-muted);
}

.settings-prompt-notice.is-info {
  color: var(--info);
}

.settings-prompt-notice.is-error {
  color: var(--error);
}

.settings-action-inline {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.settings-stall-card {
  gap: 8px;
}

.settings-stall-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 4px;
}

.settings-stall-input {
  width: 100px;
  background: rgba(33, 33, 33, 0.7);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  color: var(--text-pri);
  font-family: "Menlo", "Consolas", monospace;
  font-size: 13px;
  padding: 6px 10px;
  text-align: right;
  outline: none;
  transition: border-color var(--transition);
}

.settings-stall-input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2);
}

.settings-stall-input:disabled {
  opacity: 0.5;
}

.settings-stall-unit {
  font-size: 12px;
  color: var(--text-muted);
  white-space: nowrap;
  min-width: 80px;
}

.settings-log-empty {
  color: var(--text-muted);
  font-size: 12px;
}

.settings-log-list {
  display: grid;
  gap: 6px;
  max-height: 260px;
  overflow: auto;
}

.settings-log-item {
  display: grid;
  grid-template-columns: 66px 46px 1fr;
  gap: 8px;
  align-items: center;
  padding: 5px 8px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: rgba(33, 33, 33, 0.6);
  font-size: 11px;
  color: var(--text-sec);
}

.settings-log-time {
  color: var(--text-subtle);
  font-family: "Menlo", "Consolas", monospace;
}

.settings-log-level {
  font-weight: 600;
  text-transform: uppercase;
  color: var(--text-muted);
}

.settings-log-level.is-debug {
  color: var(--text-muted);
}

.settings-log-level.is-info {
  color: var(--info);
}

.settings-log-level.is-warn {
  color: var(--warning);
}

.settings-log-level.is-error {
  color: var(--error);
}

.settings-log-event {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-family: "Menlo", "Consolas", monospace;
}

.split-duo {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.skills-page .skills-list-panel,
.skills-page .skills-editor-panel {
  gap: 10px;
}

.skills-toolbar {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.skill-card.active {
  border-color: var(--primary);
  box-shadow: 0 0 0 1px rgba(180, 185, 195, 0.22);
}

.skill-actions {
  gap: 6px;
}

.skill-summary-row {
  align-items: flex-start;
}

.skill-summary-cell {
  flex: 1;
  min-width: 0;
  display: grid;
  gap: 6px;
}

.skill-summary-text {
  border: 1px dashed var(--border);
  border-radius: var(--radius-sm);
  background: rgba(33, 33, 33, 0.35);
  color: var(--text);
  text-align: left;
  padding: 7px 10px;
  line-height: 1.45;
  cursor: pointer;
  transition: border-color var(--transition), background var(--transition);
}

.skill-summary-text:hover {
  border-color: var(--primary);
  background: rgba(33, 33, 33, 0.55);
}

.skill-summary-input {
  min-height: 72px;
  resize: vertical;
}

.skill-summary-actions {
  display: flex;
  justify-content: flex-end;
  gap: 6px;
}

.skills-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.skills-field label {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 600;
}

.skills-field.two-col {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 8px;
}

.skills-inline-tip {
  font-size: 11px;
  color: var(--text-subtle);
}

.skills-body-input {
  min-height: 220px;
  resize: vertical;
}

.skills-actions-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.skills-notice {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 8px 10px;
  font-size: 12px;
  color: var(--text-sec);
  background: rgba(33, 33, 33, 0.6);
}

.skills-notice.is-success {
  border-color: rgba(34, 197, 94, 0.35);
  color: #86efac;
}

.skills-notice.is-error {
  border-color: rgba(248, 113, 113, 0.4);
  color: #fecaca;
}

.skills-failure-list {
  margin: 0;
  padding-left: 18px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  color: var(--text-subtle);
  font-size: 11px;
  max-height: 120px;
  overflow: auto;
}

/* ======================================== */
/* ActivityPanel -           */
/* ======================================== */

/* : DiffPanel + ActivityPanel  */
.workspace-right-col {
  display: flex;
  flex-direction: column;
  min-width: 0;
  min-height: 0;
  overflow: hidden;
  border-left: 1px solid var(--border);
}

/* #diff-panel :  flex:4  */
.workspace-right-col #diff-panel {
  flex: 1;
  min-height: 0;
  border-left: none;
}

.activity-panel {
  display: flex;
  flex-direction: column;
  flex-shrink: 0;
  min-width: 0;
  height: 140px;
  background: linear-gradient(180deg, rgba(24, 24, 24, 0.98) 0%, rgba(12, 12, 12, 0.98) 100%);
  border-top: none;
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.3);
  overflow: hidden;
  font-family: "SF Mono", "Menlo", monospace;
}

/* ---  (stats row) --- */

.activity-stats {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  cursor: pointer;
  transition: background var(--transition);
  flex-shrink: 0;
}

.activity-stats:hover {
  background: rgba(255, 255, 255, 0.06);
}

.activity-stats .stat {
  font-size: 11px;
  line-height: 1.2;
  white-space: nowrap;
}

.activity-stats .stat strong {
  margin-left: 2px;
  font-weight: 600;
}

.stat-lsp {
  color: #22d3ee;
}

.stat-cmd {
  color: #4ade80;
}

.stat-file {
  color: #fbbf24;
}

.stat-tool {
  color: #a78bfa;
}

.stat-sep {
  color: var(--text-subtle);
  font-size: 10px;
  user-select: none;
}

/* ---  (expandable) --- */

.activity-tool-detail {
  display: flex;
  flex-wrap: wrap;
  gap: 4px 8px;
  padding: 4px 10px 6px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  max-height: 64px;
  overflow-y: auto;
  flex-shrink: 0;
}

.tool-entry {
  font-size: 10px;
  color: var(--text-muted);
  white-space: nowrap;
}

.tool-entry strong {
  color: var(--text-sec);
  margin-left: 2px;
  font-weight: 600;
}

/* ---  (alerts) --- */

.activity-alerts {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  padding: 4px 0;
}

.activity-alerts.empty {
  display: flex;
  align-items: center;
  justify-content: center;
}

.alert-empty {
  font-size: 10px;
  color: var(--text-subtle);
  text-align: center;
  padding: 4px 10px;
}

.alert-line {
  display: flex;
  align-items: baseline;
  gap: 5px;
  padding: 2px 10px;
  font-size: 10px;
  line-height: 1.5;
}

.alert-line.alert-line-command {
  align-items: flex-start;
  gap: 6px;
  padding: 3px 8px;
}

.alert-line.alert-line-command .alert-time {
  padding-top: 2px;
}

.activity-command-entry {
  flex: 1;
  min-width: 0;
  font-size: 10px;
}

.activity-command-entry .ran-command-card__header {
  margin-bottom: 0;
  padding: 2px 6px;
}

.activity-command-entry .ran-command-card__main-row {
  min-height: 18px;
  padding: 2px 6px;
}

.activity-command-entry .ran-command-card__title {
  font-size: 10px;
}

.activity-command-entry .ran-command-card__details--open {
  max-height: 64px;
}

.activity-command-entry .ran-command-card__footer {
  padding: 2px 6px;
  font-size: 10px;
}

.activity-command-output {
  padding: 4px 6px;
  font-size: 10px;
  line-height: 1.35;
  max-height: 58px;
}

.alert-time {
  color: var(--text-subtle);
  flex-shrink: 0;
  font-size: 10px;
}

.alert-icon {
  flex-shrink: 0;
  font-size: 11px;
}

.alert-msg {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.alert-msg-wrap {
  overflow: visible;
  text-overflow: clip;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
}

.alert-line.alert-error .alert-icon,
.alert-line.alert-error .alert-msg {
  color: var(--error);
}

.alert-line.alert-warning .alert-icon,
.alert-line.alert-warning .alert-msg {
  color: var(--warning);
}

.alert-line.alert-info .alert-icon,
.alert-line.alert-info .alert-msg {
  color: var(--info);
}

/* ======================================== */
/* json-render Widgets                       */
/* ======================================== */

.jr-root {
  margin: 8px 0;
}

.jr-mixed>.jr-root {
  margin: 12px 0;
}

/* --- Card --- */

.jr-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--surface);
  overflow: hidden;
}

.jr-card-header {
  padding: 10px 14px 8px;
  border-bottom: 1px solid var(--border);
}

.jr-card-title {
  margin: 0;
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  line-height: 1.3;
}

.jr-card-desc {
  margin: 4px 0 0;
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
}

.jr-card-body {
  padding: 10px 14px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* --- Metric --- */

.jr-metric {
  display: flex;
  flex-direction: column;
  gap: 2px;
  padding: 8px 12px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: rgba(33, 33, 33, 0.6);
}

.jr-metric-label {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 500;
  letter-spacing: 0.02em;
}

.jr-metric-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text);
  line-height: 1.2;
  font-variant-numeric: tabular-nums;
}

/* --- Stack --- */

.jr-stack {
  display: flex;
}

.jr-stack-col {
  flex-direction: column;
}

.jr-stack-row {
  flex-direction: row;
  flex-wrap: wrap;
}

/* --- Heading --- */

.jr-heading {
  margin: 0;
  color: var(--text);
  line-height: 1.3;
}

h1.jr-heading {
  font-size: 18px;
  margin-bottom: 4px;
}

h2.jr-heading {
  font-size: 15px;
  margin-bottom: 3px;
}

h3.jr-heading {
  font-size: 13px;
  margin-bottom: 2px;
}

h4.jr-heading {
  font-size: 12px;
  margin-bottom: 2px;
}

/* --- Table --- */

.jr-table-wrap {
  overflow-x: auto;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
}

.jr-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}

.jr-table-th {
  padding: 7px 10px;
  font-weight: 600;
  color: var(--text-sec);
  background: rgba(33, 33, 33, 0.75);
  border-bottom: 1px solid var(--border);
  white-space: nowrap;
}

.jr-table-td {
  padding: 6px 10px;
  color: var(--text);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

.jr-table tbody tr:last-child .jr-table-td {
  border-bottom: none;
}

.jr-table tbody tr:hover .jr-table-td {
  background: rgba(255, 255, 255, 0.04);
}

/* --- Unknown type fallback --- */

.jr-unknown {
  border: 1px dashed rgba(248, 113, 113, 0.4);
  border-radius: var(--radius-sm);
  padding: 6px 10px;
  background: rgba(248, 113, 113, 0.06);
}

.jr-unknown-type {
  font-size: 11px;
  color: var(--text-muted);
  font-family: "Menlo", monospace;
}

.jr-empty {
  font-size: 12px;
  color: var(--text-subtle);
  padding: 8px;
}

/* --- Alert --- */

.jr-alert {
  display: flex;
  gap: 8px;
  padding: 10px 14px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  align-items: flex-start;
}

.jr-alert-info {
  border-color: rgba(180, 185, 195, 0.42);
  background: rgba(180, 185, 195, 0.1);
}

.jr-alert-warning {
  border-color: rgba(251, 191, 36, 0.4);
  background: rgba(251, 191, 36, 0.06);
}

.jr-alert-error {
  border-color: rgba(248, 113, 113, 0.4);
  background: rgba(248, 113, 113, 0.06);
}

.jr-alert-success {
  border-color: rgba(34, 197, 94, 0.35);
  background: rgba(34, 197, 94, 0.06);
}

.jr-alert-icon {
  flex-shrink: 0;
  font-size: 14px;
  line-height: 1.3;
}

.jr-alert-content {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

.jr-alert-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
}

.jr-alert-msg {
  font-size: 12px;
  color: var(--text-sec);
  line-height: 1.5;
}

/* --- Badge --- */

.jr-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 600;
  line-height: 1.3;
  white-space: nowrap;
}

.jr-badge-default {
  background: rgba(255, 255, 255, 0.15);
  color: var(--text-sec);
  border: 1px solid rgba(255, 255, 255, 0.25);
}

.jr-badge-primary {
  background: rgba(180, 185, 195, 0.16);
  color: #e5e7eb;
  border: 1px solid rgba(180, 185, 195, 0.4);
}

.jr-badge-success {
  background: rgba(34, 197, 94, 0.12);
  color: #86efac;
  border: 1px solid rgba(34, 197, 94, 0.3);
}

.jr-badge-warning {
  background: rgba(251, 191, 36, 0.12);
  color: #fde68a;
  border: 1px solid rgba(251, 191, 36, 0.3);
}

.jr-badge-error {
  background: rgba(248, 113, 113, 0.12);
  color: #fca5a5;
  border: 1px solid rgba(248, 113, 113, 0.35);
}

/* --- CodeBlock --- */

.jr-codeblock {
  position: relative;
  padding: 10px 14px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  background: rgba(33, 33, 33, 0.75);
  font-family: "Menlo", "Consolas", monospace;
  font-size: 12px;
  line-height: 1.55;
  color: var(--text);
  overflow-x: auto;
  white-space: pre;
  margin: 0;
}

.jr-codeblock-lang {
  position: absolute;
  top: 4px;
  right: 8px;
  font-size: 10px;
  color: var(--text-subtle);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

/* --- List --- */

.jr-list {
  margin: 0;
  padding-left: 20px;
  font-size: 12px;
  color: var(--text);
  line-height: 1.6;
}

.jr-list-item {
  padding: 1px 0;
}

/* --- Button --- */

.jr-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 6px 14px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s, color 0.15s;
  border: 1px solid var(--border);
}

.jr-button-default {
  background: rgba(33, 33, 33, 0.75);
  color: var(--text-sec);
}

.jr-button-default:hover {
  background: rgba(48, 48, 48, 0.95);
  color: var(--text);
  border-color: var(--border-hover);
}

.jr-button-primary {
  background: rgba(180, 185, 195, 0.2);
  color: #f3f4f6;
  border-color: rgba(180, 185, 195, 0.46);
}

.jr-button-primary:hover {
  background: rgba(180, 185, 195, 0.3);
}

.jr-button-danger {
  background: rgba(248, 113, 113, 0.12);
  color: #fca5a5;
  border-color: rgba(248, 113, 113, 0.4);
}

.jr-button-danger:hover {
  background: rgba(248, 113, 113, 0.22);
}

/* --- Progress --- */

.jr-progress {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.jr-progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.jr-progress-label {
  font-size: 11px;
  color: var(--text-muted);
}

.jr-progress-pct {
  font-size: 11px;
  color: var(--text-sec);
  font-variant-numeric: tabular-nums;
}

.jr-progress-track {
  height: 6px;
  border-radius: 3px;
  background: rgba(255, 255, 255, 0.15);
  overflow: hidden;
}

.jr-progress-fill {
  height: 100%;
  border-radius: 3px;
  background: linear-gradient(90deg, rgba(181, 187, 197, 0.76), rgba(216, 220, 227, 0.96));
  transition: width 0.3s ease;
}

/* --- Tabs --- */

.jr-tabs {
  display: flex;
  flex-direction: column;
}

.jr-tabs-header {
  display: flex;
  gap: 0;
  border-bottom: 1px solid var(--border);
}

.jr-tab-btn {
  padding: 6px 14px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-muted);
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: color 0.15s, border-color 0.15s;
}

.jr-tab-btn:hover {
  color: var(--text-sec);
}

.jr-tab-btn.active {
  color: var(--text);
  border-bottom-color: var(--primary);
}

.jr-tabs-body {
  padding: 10px 0;
}

/* --- Accordion --- */

.jr-accordion {
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.jr-accordion-trigger {
  display: flex;
  width: 100%;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  background: rgba(33, 33, 33, 0.6);
  border: none;
  cursor: pointer;
  transition: background 0.15s;
}

.jr-accordion-trigger:hover {
  background: rgba(33, 33, 33, 0.75);
}

.jr-accordion-arrow {
  font-size: 10px;
  color: var(--text-muted);
  transition: transform 0.2s;
}

.jr-accordion-body {
  padding: 10px 12px;
}

/* --- Separator --- */

.jr-separator {
  border: none;
  border-top: 1px solid var(--border);
  margin: 8px 0;
}

.jr-separator-labeled {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 8px 0;
}

.jr-separator-line {
  flex: 1;
  border: none;
  border-top: 1px solid var(--border);
}

.jr-separator-text {
  font-size: 11px;
  color: var(--text-subtle);
  white-space: nowrap;
}

/* --- Image --- */

.jr-image {
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.jr-image-img {
  max-width: 100%;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
}

.jr-image-caption {
  font-size: 11px;
  color: var(--text-muted);
  text-align: center;
}

/* --- Link --- */

.jr-link {
  color: var(--primary);
  text-decoration: none;
  font-size: 12px;
}

.jr-link:hover {
  text-decoration: underline;
}

/* --- Stat --- */

.jr-stat {
  display: flex;
  flex-direction: column;
  gap: 2px;
  padding: 8px 12px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: rgba(33, 33, 33, 0.6);
}

.jr-stat-label {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 500;
}

.jr-stat-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text);
  line-height: 1.2;
}

.jr-stat-change {
  font-size: 11px;
  font-weight: 600;
  margin-top: 2px;
}

.jr-stat-up {
  color: #4ade80;
}

.jr-stat-down {
  color: #f87171;
}

/* --- Timeline --- */

.jr-timeline {
  display: flex;
  flex-direction: column;
}

.jr-timeline-item {
  display: flex;
  gap: 10px;
  min-height: 40px;
}

.jr-timeline-dot-col {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-shrink: 0;
  width: 16px;
  padding-top: 4px;
}

.jr-timeline-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  border: 2px solid var(--border);
  background: rgba(33, 33, 33, 0.75);
  flex-shrink: 0;
}

.jr-dot-done {
  border-color: #4ade80;
  background: rgba(34, 197, 94, 0.25);
}

.jr-dot-active {
  border-color: var(--primary);
  background: rgba(181, 187, 197, 0.28);
}

.jr-dot-pending {
  border-color: var(--border);
}

.jr-timeline-line {
  flex: 1;
  width: 2px;
  background: var(--border);
  margin: 4px 0;
  min-height: 16px;
}

.jr-timeline-content {
  flex: 1;
  padding-bottom: 12px;
}

.jr-timeline-head {
  display: flex;
  gap: 8px;
  align-items: baseline;
}

.jr-timeline-head strong {
  font-size: 12px;
  color: var(--text);
}

.jr-timeline-time {
  font-size: 11px;
  color: var(--text-subtle);
}

.jr-timeline-desc {
  font-size: 12px;
  color: var(--text-sec);
  margin: 2px 0 0;
  line-height: 1.5;
}

/*  Chart (ECharts)  */
.jr-chart {
  border: 1px solid var(--color-border, #ffffff14);
  border-radius: 10px;
  background: var(--color-background-elevated-primary, #212121f5);
  padding: 8px;
  min-height: 200px;
  overflow: hidden;
}
